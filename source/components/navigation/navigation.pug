include ../button/button

mixin navigation(userName)
  include ./navigation-data
  - let menu = locals.navMenu;

  .nav.nav_closed.js-nav(data-name="nav")
    button.nav__toggle.js-toggle(type="button", aria-label="Открыть меню")
      i.nav__toggle_menu.material-icons menu
      i.nav__toggle_close.material-icons close
    .nav__wrapper
      ul.nav__list.nav__list_site
        each item in menu
          +navigationItem(item)
      ul.nav__list.nav__list_user
        if userName
          li.nav__item
            a.nav__user(href="/mock-address/change-me")= userName
        else
          li.nav__item
            +button({link: "login.html", mode: ["text", "bordered", "thin"], text: "Войти", })
          li.nav__item
            +button({link: "registration.html", mode: ["colored", "thin"], text: "Зарегистрироваться", })

mixin navigationItem(item)
  if !item.sub
    li.nav__item
      a.nav__link(href=item.href)= item.title
  else
    li.nav__item.nav__item_sub
      a.nav__link(tabindex="0")= item.title
      ul.nav__sub
        each subItem in item.sub
          +navigationSub(subItem)

mixin navigationSub(subItem)
  li.nav__sub-item
    a.nav__sub-link(href=subItem.href)= subItem.title
