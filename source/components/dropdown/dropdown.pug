include ../input/input
include ../button/button


mixin dropdown(options)
  include ./dropdown-data

  if !options
    - options = {}

  - let classes = []

  if options.isGuestsDropdown
    - attributes.placeholder = "Сколько гостей"
    - options.isDropdownSelect = true
    - options.list = locals.guestsList
    - classes.push("dropdown--guests")

  if options.isComfortDropdown
    - options.isDropdownSelect = true
    - options.list = locals.comfortList
    - classes.push("dropdown--comfort")

  if options.isDropdownSelect
    - classes.push("js-dropdown dropdown--hidden")
    - attributes.type = "text"
    - attributes.readonly = true

  if options.isDateDropdown
    - options.isDateMask = true
    - options.isDatepicker = true
    - classes.push("dropdown--date")

  if options.isFilterDateDropdown
    - options.isDatepickerFilter = true
    - attributes.placeholder = "19 авг - 23 авг"
    - classes.push("dropdown--filter-date")


  .dropdown(class=classes data-show=options.dataShow)
    if options.label
      label.dropdown__label(for=options.id)= options.label
    - attributes.class = "dropdown__input"
    +input(options)&attributes(attributes)
    if options.isDropdownSelect
      +dropdownSelect(options.list)


mixin dropdownSelect(list)
  .dropdown__select.js-dropdown__select
    ul.dropdown__list
      for item in list
        +dropdownItem(item)
    .dropdown__buttons
      +button({
        buttonMod: "text",
        type: "button",
        desc: "Очистить"
        })
      +button({
        buttonMod: "text",
        type: "button",
        desc: "Применить"
        })

mixin dropdownItem(item)
  li.dropdown__item.js-dropdown__item
    span.dropdown__option(data-option=item.data)= item.option

    .dropdown__number.js-dropdown__number
      button.dropdown__number-button(type="button", data-action="minus")
      +input()(
        class = "dropdown__total js-dropdown__total"
        type = "number"
        disabled = true
        maxlength = 2
        value = item.defaultVal
        )
      button.dropdown__number-button(type="button", data-action="plus")
